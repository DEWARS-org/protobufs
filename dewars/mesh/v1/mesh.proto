syntax = "proto3";

package dewars.mesh.v1;

message Packet {
  int32 path = 1;
  int32 hops_remaining = 2;
  oneof payload {
    NetworkPayload network = 3;
    ControlPayload control = 4;
  }
}

message MeshTable {
  map<int32, string> table = 1;
}

message NetworkPayload {
  message Segment {
    uint32 counter = 1;
    string data = 2;
  }
  map<uint32, Segment> segments = 1;
}

message ControlPayload {
  enum Type {
    REQUEST_SEGMENT = 0;
    REQUEST_ALL = 1;
  }
  uint32 id = 1;
  Type type = 2;
  uint32 mesh_id = 3;
  uint32 segment_id = 4;
}
